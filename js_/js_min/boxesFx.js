!function(t){"use strict";function e(e){var i,n;return"x"===e?(i=s.clientWidth,n=t.innerWidth):"y"===e&&(i=s.clientHeight,n=t.innerHeight),i<n?n:i}function i(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i]);return t}function n(t,e){this.el=t,this.options=i({},this.options),i(this.options,e),this._init()}var s=t.document.documentElement,r={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",msTransition:"MSTransitionEnd",transition:"transitionend"}[Modernizr.prefixed("transition")],a={transitions:Modernizr.csstransitions},o={width:e("x"),height:e("y")};n.prototype.options={},n.prototype._init=function(){this._setTransforms(),this.effect=this.el.getAttribute("data-effect")||"effect-1",this.isAnimating=!1,this.panels=[].slice.call(this.el.querySelectorAll(".panel")),this.panelsCount=4,this.current=0,classie.add(this.panels[0],"current");var t=this;this.panels.forEach(function(e){for(var i=e.querySelector("img"),n="",s=0;s<t.panelsCount;++s)n+='<div class="bg-tile"><div class="bg-img"><img src="'+i.src+'" /></div></div>';e.removeChild(i),e.innerHTML=n+e.innerHTML}),this.nav=document.createElement("nav"),this.nav.innerHTML='<span class="prev"><i></i></span><span class="next"><i></i></span>',this.el.appendChild(this.nav),this._initEvents()},n.prototype._setTransforms=function(){this.transforms={"effect-1":{next:["translate3d(0, "+(o.height/2+10)+"px, 0)","translate3d(-"+(o.width/2+10)+"px, 0, 0)","translate3d("+(o.width/2+10)+"px, 0, 0)","translate3d(0, -"+(o.height/2+10)+"px, 0)"],prev:["translate3d("+(o.width/2+10)+"px, 0, 0)","translate3d(0, "+(o.height/2+10)+"px, 0)","translate3d(0, -"+(o.height/2+10)+"px, 0)","translate3d(-"+(o.width/2+10)+"px, 0, 0)"]},"effect-2":{next:["translate3d(-"+(o.width/2+10)+"px, 0, 0)","translate3d("+(o.width/2+10)+"px, 0, 0)","translate3d(-"+(o.width/2+10)+"px, 0, 0)","translate3d("+(o.width/2+10)+"px, 0, 0)"],prev:["translate3d(0,-"+(o.height/2+10)+"px, 0)","translate3d(0,-"+(o.height/2+10)+"px, 0)","translate3d(0,"+(o.height/2+10)+"px, 0)","translate3d(0,"+(o.height/2+10)+"px, 0)"]},"effect-3":{next:["translate3d(0,"+(o.height/2+10)+"px, 0)","translate3d(0,"+(o.height/2+10)+"px, 0)","translate3d(0,"+(o.height/2+10)+"px, 0)","translate3d(0,"+(o.height/2+10)+"px, 0)"],prev:["translate3d(0,-"+(o.height/2+10)+"px, 0)","translate3d(0,-"+(o.height/2+10)+"px, 0)","translate3d(0,-"+(o.height/2+10)+"px, 0)","translate3d(0,-"+(o.height/2+10)+"px, 0)"]}}},n.prototype._initEvents=function(){var e=this,i=this.nav.children;i[0].addEventListener("click",function(){e._navigate("prev")}),i[1].addEventListener("click",function(){e._navigate("next")}),t.addEventListener("resize",function(){e._resizeHandler()})},n.prototype._navigate=function(t){if(this.isAnimating)return!1;this.isAnimating=!0;var e=this,i=this.panels[this.current];this.current="next"===t?this.current<this.panelsCount-1?this.current+1:0:this.current>0?this.current-1:this.panelsCount-1;var n=this.panels[this.current];classie.add(n,"active"),this._applyTransforms(i,t);var s=0,o=function(t){return!(t&&!classie.has(t.target,"bg-img"))&&(!(++s<e.panelsCount)&&(a.transitions&&this.removeEventListener(r,o),classie.remove(i,"current"),classie.add(n,"current"),e._resetTransforms(i),classie.remove(n,"active"),void(e.isAnimating=!1)))};a.transitions?i.addEventListener(r,o):o()},n.prototype._applyTransforms=function(t,e){var i=this;[].slice.call(t.querySelectorAll("div.bg-img")).forEach(function(t,n){t.style.WebkitTransform=i.transforms[i.effect][e][n],t.style.transform=i.transforms[i.effect][e][n]})},n.prototype._resetTransforms=function(t){[].slice.call(t.querySelectorAll("div.bg-img")).forEach(function(t){t.style.WebkitTransform="none",t.style.transform="none"})},n.prototype._resizeHandler=function(){var t=this;this._resizeTimeout&&clearTimeout(this._resizeTimeout),this._resizeTimeout=setTimeout(function(){t._resize(),t._resizeTimeout=null},50)},n.prototype._resize=function(){o.width=e("x"),o.height=e("y"),this._setTransforms()},t.BoxesFx=n}(window);